<!DOCTYPE html>
<html lang="fr">
<head>
	<meta charset="UTF-8" />
	<title>Upload</title>
</head>
<body style="background-color: lightblue;">
	<form method="POST" action="/cgi-bin/apply-for-iceberg.pl?/upload" enctype="multipart/form-data">
		<p>
			<input type="file" name="form" value="R-42" accept="image/png, image/jpeg" multiple required />
		</p>
		<p>
			<input type="submit" name="submit" value="RÃ©server un iceberg" />
			<input type="reset" name="reset" value="Reset" />
		</p>
	</form>
	<!-- Ici ca renvoie vers une requete GET. Les requetes DELETE ne sont pas gerees par les balises HTML, Il faudrait le faire manuellement, jsp ou mais le cgi peut pas gerer ca a lui seul-->
	<hr>
	<form id="delete-form" method="DELETE" action="/cgi-bin/apply-for-iceberg.pl?/upload" enctype="multipart/form-data">
		<!--<p>
			<input type="file" name="form" value="R-42" accept="image/png, image/jpeg" multiple required />
		</p>-->
		<p>
			<input type="hidden" name="path_info" value="/upload"/>
		</p>
		<p>
			<input type="submit" name="submit" value="Supprimer un iceberg" />
			<input type="reset" name="reset" value="Reset" />
		</p>
		<pre id="output" style="max-height:300px;">
		</pre>
	</form>
	<script>
	document.getElementById('delete-form').addEventListener('submit', function (event) {
		const data = new URLSearchParams(new FormData(document.getElementById('delete-form')))

		fetch(document.getElementById('delete-form').action, {
		    method: 'DELETE',
		    body: data,
		}).then(function(response) {
			return response.text()
		})
		.then((data) => {
			document.getElementById('output').textContent = data
		})

		event.preventDefault()
	})
	</script>
	<hr>
	<!-- Impossible de recuperer le path_info /upload de cette facon la par une requete GET, c'est remplacer par la query string generee par submit -->
	<form method="GET" action="/cgi-bin/apply-for-iceberg.pl?/upload" enctype="multipart/form-data">
		<p>
			<input type="hidden" name="path_info" value="/upload"/>
		</p>
		<p>
			<input type="submit" name="submit" value="Obtenir un iceberg" />
			<input type="reset" name="reset" value="Reset" />
		</p>
	</form>
</body>
</html>
